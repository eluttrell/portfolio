server {
    # Nginx listens on port 80 inside the container
    listen 80;

    # Set the default file to serve (Next.js entry point)
    index index.html;

    # Root directory where the static files were copied from /app/out
    root /usr/share/nginx/html; 

    # --- Content API Endpoint Simulation ---
    # Handles fetch('/api/content.json') requests from your frontend
    location /api/content.json {
        # CRITICAL: 'alias' tells Nginx to look at this specific file path, 
        # which is where the content.json file is VOLUME MOUNTED by Docker Compose.
        alias /etc/nginx/content/content.json; 
        default_type application/json;
    }

    # --- Next.js SPA Routing ---
    # Handles all other routes (like /, /contact, /projects)
    location / {
        # CRITICAL: This directive tries to find the URI first (for static assets), 
        # then falls back to index.html. This is essential for Next.js client-side routing.
        try_files $uri $uri/ /index.html;
    }
}